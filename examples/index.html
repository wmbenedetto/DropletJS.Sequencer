<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>DropletJS.Sequence</title>

    <link href="assets/bootstrap.min.css" type="text/css" rel="stylesheet" />
    <link href="assets/prettify.css" type="text/css" rel="stylesheet" />

    <script language="JavaScript" type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js" type="text/javascript" async=""></script>
    <script language="JavaScript" type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="assets/prettify.js"></script>
    <script language="JavaScript" type="text/javascript" src="../src/DropletJS.Sequence.js"></script>

    <style type="text/css">
        body {
            margin:15px auto 0 auto;
            width:980px;
        }

        h1, h2, h3 {
            margin-top:24px;
        }

        .example {

            border:1px solid #ccc;
            margin:16px 0;
            padding:10px;
            overflow: hidden;
        }

        .box {
            background:#666;
            color:white;
            font-size:18px;
            font-weight:bold;
            text-align:center;
            height:50px;
            float:left;
            margin:10px;
            width:50px;
        }

        .buttons {
            clear:left;
        }

        .button {
            float:left;
            margin:10px;
        }
    </style>

    <script type="text/javascript">

        Array.prototype.shuffle = function() {
            var i = this.length, j, tempi, tempj;
            if ( i == 0 ) return false;
            while ( --i ) {
                j       = Math.floor( Math.random() * ( i + 1 ) );
                tempi   = this[i];
                tempj   = this[j];
                this[i] = tempj;
                this[j] = tempi;
            }
            return this;
        };

        $(document).ready(function(){

            $('script').each(function(){

                var id = $(this).attr('id');

                if (typeof id === 'string'){
                    var pre = $('pre.'+id+'-code').html($(this).html());
                }
            });

            $('.button').click(function(){
                $('.box').css({
                    height: '50px',
                    width: '50px'
                });
            });
        });
    </script>

    <script type="text/javascript" id="example-1">
    $(document).ready(function(){
        $('.example-1 .button').click(function(){
           $('.example-1 .box-1').animate({
               height : '100px'
           },function(){
                $('.example-1 .box-2').animate({
                   width: '100px'
               }, function(){
                    $('.example-1 .box-2').animate({
                        height:'100px'
                    }, function(){
                        $('.example-1 .box-3').animate({
                            height:'100px'
                        })
                    });
                });
            });
        });
    });
    </script>

    <script type="text/javascript" id="example-2">
    $(document).ready(function(){
        $('.example-2 .button-1').click(function(){
           $('.example-2 .box-1').animate({
               height : '100px'
           },function(){
                $('.example-2 .box-2').animate({
                   width: '100px'
               }, function(){
                    $('.example-2 .box-2').animate({
                        height:'100px'
                    }, function(){
                        $('.example-2 .box-3').animate({
                            height:'100px'
                        })
                    });
                });
            });
        });

        $('.example-2 .button-2').click(function(){
            $('.example-2 .box-1').animate({
               height : '100px'
            },function(){
                $('.example-2 .box-3').animate({
                   height: '100px'
                }, function(){
                    $('.example-2 .box-2').animate({
                        height:'100px'
                    }, function(){
                        $('.example-2 .box-2').animate({
                            width:'100px'
                        })
                    });
                });
            });
        });
    });
    </script>

    <script type="text/javascript" id="example-3">
    var box1Height = function(seq){
        $('.example-3 .box-1').animate({ height : '100px' }, seq.next);
    };

    var box2Width = function(seq){
        $('.example-3 .box-2').animate({ width : '100px' }, seq.next);
    };

    var box2Height = function(seq){
        $('.example-3 .box-2').animate({ height : '100px' }, seq.next);
    };

    var box3Height = function(seq){
        $('.example-3 .box-3').animate({ height : '100px' }, seq.next);
    };

    $(document).ready(function(){

        $('.example-3 .button-1').click(function(){
            var example3Seq = new DropletJS.Sequence([box1Height,box2Width,box2Height,box3Height]).run();
        });

        $('.example-3 .button-2').click(function(){
            var example3Seq = new DropletJS.Sequence([box1Height,box3Height,box2Width,box2Height]).run();
        });

        $('.example-3 .button-3').click(function(){
            var example3Seq = new DropletJS.Sequence([box3Height,box2Width,box2Height,box1Height]).run();
        });

        $('.example-3 .button-4').click(function(){
            var example3Seq = new DropletJS.Sequence([box2Width,box2Height,box1Height,box3Height]).run();
        });

        $('.example-3 .button-5').click(function(){
            var example3Seq = new DropletJS.Sequence([box2Width,box2Height,box1Height,box3Height].shuffle()).run();
        });
    });
    </script>
</head>
<body onload="prettyPrint();">

    <h1>DropletJS.Sequence</h1>

    <p>One of the great things about JavaScript is its asynchronous nature. Except when you actually <em>want</em> things to be synchronous.</p>
    <p>Why would you want that?</p>
    <p>
        Say you need to fetch content from a web service via AJAX. You need to wait for the service to return the content
        before you render it with your client-side templating engine. And you need the template engine to finish rendering before
        you add content to the DOM. And you need content added to the DOM before you can attach handlers to elements in the page.
        And you need handlers attached to the page elements before you display it to the user.
    </p>
    <p>
        Or maybe you have a complex series of animations, each of which needs to finish before the next one begins. Fade this out,
        then slide this up, then expand that, then fade those other things in.
    </p>
    <p>
        Can you do all this without DropletJS.Sequence? Sure, if you like tightly coupled code that's isn't modular or reusable.
        You can just load up your code with callbacks, conditionals, and nested functions until it's a tangled, unmaintainable mess.
    </p>
    <p>
        But you shouldn't.
    </p>
    <p>
        Let's take a look at a sequential animation example, without DropletJS.Sequence:
    </p>

    <h3>Animation Example (without DropletJS.Sequence)</h3>
    <p>
        Let's start with three squares. We'll increase the height of the first, then the width of the second, then the height of
        the second, then the height of the third.
    </p>
    <div class="example-1 example">
        <div class="box-1 box">1</div>
        <div class="box-2 box">2</div>
        <div class="box-3 box">3</div>
        <div class="buttons">
            <input type="button" value="Run 1-2-3" class="button" />
        </div>
    </div>
    <p>
        Without DropletJS.Sequence, your code might look like this:
    </p>
    <pre class="prettyprint lang-js example-1-code"></pre>
    <p>
        Pretty ugly, but not completely unreadable.
    </p>
    <p>Okay, now what happens if we want to change the order in which boxes resize? What if we want the third box to resize after the first, with the middle box resizing last?</p>
    <p>Oh, and we want to do it <em>conditionally</em> based on the button clicked.</p>
    <div class="example-2 example">
        <div class="box-1 box">1</div>
        <div class="box-2 box">2</div>
        <div class="box-3 box">3</div>
        <div class="buttons">
            <input type="button" value="Run 1-2-3" class="button-1 button" />
            <input type="button" value="Run 1-3-2" class="button-2 button" />
        </div>
    </div>
    <p>
        Now you've got a mess.
    </p>
    <pre class="prettyprint lang-js example-2-code"></pre>
    <p>
        You've just doubled the amount of code, not to mention making it harder to maintain. And every variation and condition you add just makes the problem worse.
    </p>
    <p>Now let's look at the same example using DropletJS.Sequence:</p>
    <h3>Animation Example (with DropletJS.Sequence)</h3>
    <div class="example-3 example">
        <div class="box-1 box">1</div>
        <div class="box-2 box">2</div>
        <div class="box-3 box">3</div>
        <div class="buttons">
            <input type="button" value="Run 1-2-3" class="button-1 button" />
            <input type="button" value="Run 1-3-2" class="button-2 button" />
            <input type="button" value="Run 3-2-1" class="button-3 button" />
            <input type="button" value="Run 2-1-3" class="button-4 button" />
            <input type="button" value="Run Random Order" class="button-5 button" />
        </div>
    </div>
    <p>
        Note that we've got two additional options for different animation orders, as well as a button that randomizes
        the order each time. And yet the code that does all that is barely as much as the code for just two animation
        options in the example above.
    </p>
    <pre class="prettyprint lang-js example-3-code"></pre>
    <p>
        Ahhhh ... so much cleaner.
    </p>
    <p>
        The order of each sequence is perfectly clear, and the order of execution is completely decoupled from
        the functions themselves.
    </p>
    <p>
        All the functions know is that once they are done with their animations, they should call the next
        function in the sequence ... but they don't need to know what that next function is. This allows infinite
        ordering flexibility, with no additional code complexity.
    </p>
</body>
</html>